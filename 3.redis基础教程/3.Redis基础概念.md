视频：
录制：redis基础概述_1.mp4
日期：2026-01-30 22:43:49
录制文件：https://meeting.tencent.com/crm/2axXrx8793

录制：redis基础2_redis定义及作用.mp4
日期：2026-01-30 22:46:23
录制文件：https://meeting.tencent.com/crm/2GwkA6LP26


**学习目标**: 理解Redis是什么，为什么使用Redis

**学习内容**:

- Redis简介：内存数据库、键值存储
- Redis vs MySQL：何时使用Redis



内容：
Q1. Redis是什么？ 
是一个开源的内存数据结构存储系统

Q2：Redis的作用？

**通用作用**：
1) **缓存**：加速频繁访问的数据，支持多种淘汰策略和过期机制
2) **数据结构服务器**：提供计数器、队列、排行榜、限流器等高级语义
3) **分布式锁**：保证分布式环境下的互斥操作
4) **发布订阅**：实现消息推送和事件通知
5) **会话存储**：存储用户会话数据
6) **时间序列数据存储**：存储和查询时间序列数据

**本项目中的主要作用**（基于项目代码）：

1) **Token信息缓存** (`model/redismodel/token.go`)
   - 缓存代币信息，减少数据库查询
   - 使用Cache-Aside模式：先查Redis，未命中再查数据库
   - 过期时间：30天
   - 数据结构：String（存储JSON序列化的Token对象）

2) **K线数据存储** (`model/redismodel/kline.go`)
   - 存储K线（蜡烛图）时间序列数据
   - 使用Sorted Set，时间戳作为分数
   - 支持时间范围查询（ZRANGEBYSCORE）
   - 自定义压缩格式存储，节省内存

3) **分布式锁** (`pkg/xredis/lock.go`)
   - 防止定时任务重复执行
   - 保证链上交易检查的并发安全
   - 使用SETNX + EXPIRE实现
   - 支持锁超时和自动释放

4) **WebSocket订阅管理** (`apps/websocket/internal/svc/redischannel.go`)
   - 管理WebSocket客户端与频道的订阅关系
   - 使用Hash存储：channelKey -> clientID映射
   - 支持订阅/取消订阅操作
   - 自动过期清理（24小时）

5) **WebSocket客户端管理** (`apps/websocket/internal/svc/websocketcontext.go`)
   - 管理用户与WebSocket客户端的关联关系
   - 使用Set存储：`user:{uid}:clients` -> [clientID1, clientID2...]
   - 支持一个用户多个客户端连接
   - 客户端断线自动清理

6) **服务发现** (`pkg/discovery/discovery.go`)
   - WebSocket节点注册和发现
   - 节点心跳机制（TTL自动过期）
   - 获取活跃节点列表
   - 支持节点标签和区域筛选

7) **WebSocket集群消息广播** (`apps/websocket/internal/svc/websocket_cluster.go`)
   - 使用Pub/Sub实现跨节点消息转发
   - 节点间实时消息同步
   - 支持频道订阅和消息发布

8) **HTTP响应缓存** (`pkg/oklink/client.go`)
   - 缓存外部API调用结果
   - 使用SETEX设置过期时间
   - 减少外部API调用频率

Q3: Redis vs MySQL : 什么时候使用Redis.

**使用Redis的场景**：
1. **需要极低延迟**：实时数据查询、热点数据缓存
2. **数据结构简单或需要丰富的数据结构**：计数器、队列、集合运算、排行榜
3. **临时数据或会话数据**：用户会话、临时缓存、带过期时间的数据
4. **高并发读写**：读多写少的热点数据
5. **时间序列数据**：K线数据、监控指标
6. **分布式协调**：分布式锁、服务发现、消息队列

**使用MySQL的场景**：
1. **需要关系型数据模型**：复杂关联查询、事务一致性要求高
2. **数据持久化为主**：长期存储、需要ACID保证
3. **复杂查询和分析**：多表JOIN、复杂聚合、报表分析
4. **数据量大但访问频率不高**：历史数据存储、归档数据

**本项目的最佳实践**：
- **Redis**：Token缓存、K线数据、WebSocket订阅管理、分布式锁、服务发现
- **MySQL**：代币信息持久化、交易记录、用户数据、订单数据
- **组合使用**：MySQL作为数据源，Redis作为缓存和实时数据存储 