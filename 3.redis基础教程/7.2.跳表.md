录制：redis基础13_跳表数据结构.mp4
日期：2026-01-30 22:34:53
录制文件：https://meeting.tencent.com/crm/KD5Q3o3e69

Q1：跳表数据结构
是一种有概率性的有序数据结构，通过多层链表实现快速查找，插入和删除操作。

1）什么是跳表？
调表是一个 多层有序的链表，每一层都是有序的，高层节点少，低层节点多.

2）数据结构定义：
//跳表节点
typedef struct zskiplistNode{
    double score; //分数
    struct zskiplistNode *backward; //后向指针 （用于反向遍历）
    struct zskiplistLevel{
        struct zskiplistNode *forward; //前向指针
        unsigned long span;  //跨度 (用于计算排名)
    }level []；  //多层指针数组 (1-32层)
}zskiplistNode;

//跳表结构
typedef struct zskiplist{
    struct zskiplistNode *header,*tail/ //头节点和尾节点
    unsigned long length;  //元素数量
    int level ;  //当前最大层数
    size_t alloc_size; //分配的内存大小
}zskiplist; 

3) 示例

```
Level 3:  header ──────────────────────────────────────> NULL
           (最高层，节点最少)
Level 2:  header ──────────> node3 ────────────────────> NULL
           (第二层)
Level 1:  header ──> node1 ──> node3 ──> node5 ───────> NULL
           (第三层)
Level 0:  header ──> node1 ──> node2 ──> node3 ──> node4 ──> node5 ──> NULL
           (最底层，包含所有节点，按分数有序)
```
关键特性
- level 0: 包含所有节点，按分数从小到大有序排列
- levl 1 + : 包含部分节点，形成“快速通道”
- 每层都是有序的：按照分数从小到大
- 高层节点少，低层节点多 ： 形成类似索引的结构


Q2: 利用有序性，实现快速查找的？ 
查找分数为150的节点。 

Level 1: header ──> (Alice, 100) ──> (Bob, 200) ──> NULL
Level 0: header ──> (Alice, 100) ──> (Charlie, 150) ──> (Bob, 200) ──> NULL

LEVEL1: 从header开始：
    - header -> (Alice, 100): 150 > 100,继续
    - (Alice,100) -> (Bob,200): 150 <200,下降一层
LEVEL0: 从(Alice,100) 开始
    - （Alice,100) -> (Charlie,150): 150 == 150,找到！
