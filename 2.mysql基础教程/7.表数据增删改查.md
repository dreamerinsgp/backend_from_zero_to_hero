增删改查：https://meeting.tencent.com/crm/Kw9rV8Rk6c



## ：查询操作

### 4.1 SELECT基础

- `SELECT` 基本语法
- 选择特定字段：`SELECT field1, field2`
- 选择所有字段：`SELECT *`
- 表别名使用

### 4.2 WHERE条件查询（项目核心）

- 等值查询：`WHERE chain_id = ?`
- 范围查询：`WHERE candle_time BETWEEN ? AND ?`
- 比较查询：`WHERE candle_time > ?`
- 多条件组合：`AND`, `OR`
- 参数化查询（防止SQL注入）

**项目示例**（来自`kline_mysql.go`）：

```go
Where("chain_id = ? and candle_time > ?", chainId, candleTime)
Where("chain_id = ? and pair_address = ? and candle_time between ? and ?", ...)
```

## 第五阶段：数据操作

### 5.1 INSERT插入

- `INSERT INTO` 语法
- 单条插入
- 批量插入（性能优化）

**实例**：

```sql
-- 单条插入
INSERT INTO `block` (`slot`, `status`) VALUES (12345678, 1);

-- 单条插入（指定所有字段）
INSERT INTO `block` (`slot`, `status`, `created_at`) 
VALUES (12345679, 0, NOW());

-- 批量插入（性能优化，推荐使用）
INSERT INTO `block` (`slot`, `status`) 
VALUES 
    (12345680, 1),
    (12345681, 1),
    (12345682, 0);

-- 批量插入（从查询结果插入）
INSERT INTO `block` (`slot`, `status`)
SELECT `slot`, 1 FROM `temp_block` WHERE `status` = 0;
```

### 5.2 UPDATE更新

- `UPDATE` 语法
- `SET` 子句
- `WHERE` 条件（必须谨慎使用）

**实例**：

```sql
-- 更新单个字段
UPDATE `block` 
SET `status` = 2 
WHERE `id` = 1;

-- 更新多个字段
UPDATE `block` 
SET `status` = 1, `updated_at` = NOW() 
WHERE `slot` = 12345678;

-- 条件更新（必须使用WHERE，避免全表更新）
UPDATE `block` 
SET `status` = 2 
WHERE `status` = 0 AND `slot` < 12345600;

-- 使用子查询更新
UPDATE `block` 
SET `status` = 1 
WHERE `id` IN (SELECT `block_id` FROM `transaction` WHERE `status` = 0);
```

### 5.3 DELETE删除

- `DELETE` 语法
- 软删除模式（项目使用`deleted_at`字段）
- 物理删除 vs 软删除

**实例**：

```sql
-- 物理删除（谨慎使用，项目不推荐）
DELETE FROM `block` WHERE `id` = 1;

-- 物理删除（带条件）
DELETE FROM `block` WHERE `status` = 2 AND `slot` < 12345600;

-- 软删除（项目推荐方式，使用deleted_at字段）
UPDATE `block` 
SET `deleted_at` = NOW() 
WHERE `id` = 1;

-- 软删除后查询时需要过滤已删除记录
SELECT * FROM `block` 
WHERE `deleted_at` IS NULL AND `status` = 1;

-- 恢复软删除的记录
UPDATE `block` 
SET `deleted_at` = NULL 
WHERE `id` = 1;
```